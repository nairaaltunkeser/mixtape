<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Virtual Mixtape — Cassette</title>
  <meta name="description" content="A shareable virtual mixtape with a spinning cassette animation." />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="My Virtual Mixtape — Cassette" />
  <meta property="og:description" content="A shareable virtual mixtape with a spinning cassette animation." />
  <meta property="og:image" content="https://images.unsplash.com/photo-1530977875151-aae9742d632a?q=80&w=1600&auto=format&fit=crop" />
  <meta name="twitter:card" content="summary_large_image" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --brand: #6c5ce7;
      --ink: #f2f5f7;
      --bg: radial-gradient(1200px 700px at 20% 10%, rgba(108,92,231,.25), transparent 60%),
             radial-gradient(800px 600px at 80% 20%, rgba(0, 220, 255, .20), transparent 60%),
             linear-gradient(180deg, #0b0b10 0%, #111217 60%, #0b0b10 100%);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:var(--ink);background:var(--bg)}
    .wrap{min-height:100svh;display:grid;grid-template-rows:auto 1fr auto}
    header{padding:28px clamp(16px,4vw,40px) 0}
    .badge{display:inline-flex;gap:.5ch;align-items:center;font-size:12px;letter-spacing:.06em;text-transform:uppercase;color:#cbd3ff;background:rgba(108,92,231,.15);border:1px solid rgba(108,92,231,.35);padding:6px 10px;border-radius:999px}
    .hero{padding:24px clamp(16px,4vw,40px) 10px;display:grid;gap:22px;grid-template-columns:128px 1fr;align-items:center}
    .cover{width:128px;height:128px;border-radius:20px;overflow:hidden;border:1px solid rgba(255,255,255,.08);box-shadow:0 10px 30px rgba(0,0,0,.45), inset 0 0 0 1px rgba(255,255,255,.06);background:#151722 center/cover no-repeat}
    .title{margin:0;font-size:clamp(24px,4vw,40px);line-height:1.05;font-weight:800}
    .byline{margin:6px 0 0;color:#b9bec9;font-weight:400}
    .card{margin:10px clamp(16px,4vw,40px);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.12);border-radius:22px;overflow:clip;box-shadow:0 20px 60px rgba(0,0,0,.45)}
    .player{position:relative;aspect-ratio:16/9;width:100%;background:#0e0f12}
    iframe{width:100%;height:100%;border:0;display:block}
    .meta{display:grid;gap:16px;grid-template-columns:1fr;padding:18px}
    .message{color:#cfd6df;line-height:1.5}
    .links{display:flex;flex-wrap:wrap;gap:8px}
    .pill{color:#eaf0ff;background:rgba(108,92,231,.18);border:1px solid rgba(108,92,231,.45);border-radius:999px;padding:8px 12px;text-decoration:none;font-size:14px}
    .pill:hover{background:rgba(108,92,231,.28)}
    .controls{display:flex;align-items:center;gap:10px;padding:10px 18px 20px}
    .btn{appearance:none;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:600}
    .btn:hover{background:rgba(255,255,255,.12)}
    footer{color:#93a0b4;padding:20px clamp(16px,4vw,40px) 40px;font-size:13px;display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}
    .heart{color:var(--brand)}

    /* ===== Cassette overlay ===== */
    .cassette{position:absolute;inset:50% auto auto 50%;translate:-50% -50%;
      width:min(70vmin,520px);height:calc(min(70vmin,520px)*0.58);
      border-radius:18px;background:linear-gradient(180deg,#20242b,#171a20);box-shadow:0 18px 60px rgba(0,0,0,.55), inset 0 0 0 2px rgba(255,255,255,.06);
      pointer-events:none;opacity:.92}
    .cassette::before,.cassette::after{content:"";position:absolute;inset:auto 0 0 0;height:22%;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02))}
    .cassette .label{position:absolute;inset:10% 8% auto 8%;height:32%;background:#f4f6ff;color:#222;border-radius:10px;box-shadow:inset 0 0 0 2px rgba(0,0,0,.06);display:flex;align-items:center;justify-content:center;font-weight:800;letter-spacing:.06em;text-transform:uppercase}
    .cassette .window{position:absolute;inset:auto 18% 26% 18%;height:28%;border-radius:10px;background:rgba(255,255,255,.06);box-shadow:inset 0 0 0 2px rgba(255,255,255,.08);display:flex;align-items:center;justify-content:space-between;padding:0 14%}
    .reel{width:22%;aspect-ratio:1;border-radius:50%;background:radial-gradient(circle at 50% 50%, #e6e6e6 0 10%, #bbb 11% 32%, #222 33% 100%);
      box-shadow:inset 0 0 0 3px rgba(0,0,0,.35), 0 0 0 2px rgba(255,255,255,.05)}
    .reel::before,.reel::after{content:"";position:absolute;inset:50% auto auto 50%;translate:-50% -50%;background:#111;border-radius:50%}
    .reel::before{width:44%;height:44%;box-shadow:inset 0 0 0 2px rgba(255,255,255,.08)}
    .reel::after{width:8%;height:8%}
    .spokes{position:absolute;inset:0;display:grid;place-items:center}
    .spokes > i{position:absolute;width:10%;height:40%;background:#111;border-radius:4px}
    .spokes > i:nth-child(1){transform:rotate(0deg)}
    .spokes > i:nth-child(2){transform:rotate(60deg)}
    .spokes > i:nth-child(3){transform:rotate(120deg)}
    .spokes > i:nth-child(4){transform:rotate(180deg)}
    .spokes > i:nth-child(5){transform:rotate(240deg)}
    .spokes > i:nth-child(6){transform:rotate(300deg)}

    .spinning .reel.left{animation:spin 2.4s linear infinite}
    .spinning .reel.right{animation:spin-reverse 2.4s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes spin-reverse{to{transform:rotate(-360deg)}}

    .cassette .accent{position:absolute;inset:auto 14px 14px auto;padding:.35rem .6rem;border-radius:999px;background:var(--brand);color:#fff;font-size:.75rem;font-weight:700;letter-spacing:.04em}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <span class="badge" aria-label="Mixtape badge">Virtual Mixtape</span>
    </header>
    <section class="hero">
      <div class="cover" id="cover"></div>
      <div>
        <h1 class="title" id="title">Cassette Mixtape</h1>
        <p class="byline" id="byline">by You</p>
      </div>
    </section>
    <main class="card" aria-label="Mixtape player">
      <div class="player">
        <!-- Cassette overlay (click-through so it won't block the iframe) -->
        <div class="cassette" id="cassette" aria-hidden="true">
          <div class="label" id="cassetteLabel">Side A — Mixtape</div>
          <div class="window">
            <div class="reel left">
              <div class="spokes"><i></i><i></i><i></i><i></i><i></i><i></i></div>
            </div>
            <div class="reel right">
              <div class="spokes"><i></i><i></i><i></i><i></i><i></i><i></i></div>
            </div>
          </div>
          <div class="accent">A60</div>
        </div>
        <iframe id="embed" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" allowfullscreen loading="lazy" title="Mixtape Player"></iframe>
      </div>
      <div class="meta">
        <p class="message" id="message">Press play — the reels spin while the music plays. For best sharing reliability, use a YouTube playlist.</p>
        <div class="links" id="links"></div>
      </div>
      <div class="controls">
        <button class="btn" id="shareBtn" type="button">Share this mixtape</button>
        <button class="btn" id="copyBtn" type="button">Copy link</button>
      </div>
    </main>
    <footer>
      <div>Made with <span class="heart">♥</span> • Works on mobile & desktop</div>
      <div id="credit"></div>
    </footer>
  </div>

  <script>
    // ---------- 1) PERSONALIZE HERE ----------
    const CONFIG = {
      title: "Eren’s Cassette Mixtape",
      byline: "for you",
      credit: "curated by Eren",
      message: "If Spotify preview is short for some listeners, use the YouTube link.",
      youtubeUrl: "https://www.youtube.com/playlist?list=PLMC9KNkIncKtPzgY-5rmhvj7fax8fdxoj",
      spotifyUrl: "https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M",
      providerUrl: "https://www.youtube.com/playlist?list=PLMC9KNkIncKtPzgY-5rmhvj7fax8fdxoj",
      coverImage: "https://images.unsplash.com/photo-1530977875151-aae9742d632a?q=80&w=1200&auto=format&fit=crop",
      theme: { primary: "#6c5ce7" },
      links: [
        { label: "Open on YouTube", url: "https://www.youtube.com/playlist?list=PLMC9KNkIncKtPzgY-5rmhvj7fax8fdxoj" },
        { label: "Open on Spotify", url: "https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M" }
      ]
    };

    // ---------- Runtime helpers ----------
    const $ = (s) => document.querySelector(s);
    function applyTheme(t){ if(t?.primary) document.documentElement.style.setProperty('--brand', t.primary); }
    function setText(sel, val){ const el=$(sel); if(el && val) el.textContent = val; }
    function setCover(url){ if(url) $('#cover').style.backgroundImage = `url('${url}')`; }

    function setMeta(cfg){
      setText('#title', cfg.title); document.title = cfg.title || document.title; setText('#byline', cfg.byline); setText('#message', cfg.message); setText('#credit', cfg.credit);
      const ogTitle=document.querySelector('meta[property="og:title"]'); const ogDesc=document.querySelector('meta[property="og:description"]'); const ogImg=document.querySelector('meta[property="og:image"]');
      if (ogTitle && cfg.title) ogTitle.setAttribute('content', cfg.title);
      if (ogDesc  && cfg.message) ogDesc.setAttribute('content', cfg.message);
      if (ogImg   && cfg.coverImage) ogImg.setAttribute('content', cfg.coverImage);
      const label = `Side A — ${cfg.title || 'Mixtape'}`; setText('#cassetteLabel', label);
    }

    function mountLinks(list){ const box=$('#links'); box.innerHTML=''; (list||[]).forEach(({label,url})=>{ if(!label||!url) return; const a=document.createElement('a'); a.className='pill'; a.href=url; a.target='_blank'; a.rel='noopener noreferrer'; a.textContent=label; box.appendChild(a); }); }

    function detectProvider(url){ if(!url) return null; const u = url.toLowerCase(); if(u.includes('youtube.')||u.includes('youtu.be')) return 'youtube'; if(u.includes('spotify.')) return 'spotify'; return null; }

    function ytEmbedFrom(url){ try{ const u=new URL(url); const list=u.searchParams.get('list'); if(list){ return `https://www.youtube-nocookie.com/embed/videoseries?list=${encodeURIComponent(list)}&modestbranding=1&rel=0`; } let id=u.searchParams.get('v'); if(!id && u.hostname.includes('youtu.be')){ id=u.pathname.split('/').filter(Boolean)[0]; } if(id){ return `https://www.youtube-nocookie.com/embed/${encodeURIComponent(id)}?modestbranding=1&rel=0`; } return url; }catch{ return url; } }

    function spotifyEmbedFrom(url){ try{ const u=new URL(url); const parts=u.pathname.split('/').filter(Boolean); const type=parts[0]; const id=parts[1]; if(type&&id) return `https://open.spotify.com/embed/${encodeURIComponent(type)}/${encodeURIComponent(id)}`; return url; }catch{ return url; } }

    function embedSrcFrom(url){ const p=detectProvider(url); if(p==='youtube') return ytEmbedFrom(url); if(p==='spotify') return spotifyEmbedFrom(url); return ''; }

    // Cassette reel control
    function startSpin(){ $('#cassette')?.classList.add('spinning'); }
    function stopSpin(){ $('#cassette')?.classList.remove('spinning'); }

    function mountEmbed(url){
      const src = embedSrcFrom(url); const iframe = $('#embed'); const provider = detectProvider(url);
      let finalSrc = src;
      if(provider==='youtube'){
        const hasQuery = src.includes('?'); const origin = encodeURIComponent(location.origin);
        finalSrc = src + (hasQuery?'&':'?') + `enablejsapi=1&origin=${origin}`;
      }
      iframe.src = finalSrc; iframe.title = `${CONFIG.title || 'Mixtape'} — ${provider || 'player'}`;

      if(provider!=='youtube'){
        // Heuristic: start spinning on first user interaction
        const container = document.querySelector('.player');
        container.addEventListener('click', ()=>startSpin(), { once:true });
        document.addEventListener('visibilitychange', ()=>{ if(document.hidden) stopSpin(); });
      }
    }

    // YouTube Iframe API to drive play/pause/ended → spin control
    let ytApiLoaded=false; let ytPlayer=null;
    function loadYouTubeAPI(){ if(ytApiLoaded) return; ytApiLoaded=true; const tag=document.createElement('script'); tag.src='https://www.youtube.com/iframe_api'; document.head.appendChild(tag); }
    window.onYouTubeIframeAPIReady = function(){ const iframe=$('#embed'); if(!iframe || !/youtube\./i.test(iframe.src)) return; ytPlayer = new YT.Player('embed', { events:{ onStateChange:(e)=>{ if(e.data===1) startSpin(); if(e.data===2||e.data===0) stopSpin(); } } }); };

    // Share / Copy
    async function sharePage(){ const shareData={ title:CONFIG.title||document.title, text:CONFIG.message||'Mixtape', url:location.href }; if(navigator.share){ try{ await navigator.share(shareData);}catch(e){} } else { await copyLink(); alert('Link copied to clipboard!'); } }
    async function copyLink(){ try{ await navigator.clipboard.writeText(location.href);}catch{ const ta=document.createElement('textarea'); ta.value=location.href; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); } }

    // Init
    (function init(cfg){
      applyTheme(cfg.theme||{}); setCover(cfg.coverImage); setMeta(cfg); mountLinks(cfg.links);
      const chosen = cfg.providerUrl || cfg.youtubeUrl || cfg.spotifyUrl; const provider = detectProvider(chosen);
      if(provider==='youtube') loadYouTubeAPI();
      mountEmbed(chosen);
      $('#shareBtn').addEventListener('click', sharePage);
      $('#copyBtn').addEventListener('click', async ()=>{ await copyLink(); alert('Link copied!'); });
    })(CONFIG);
  </script>
</body>
</html>
