<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cassette Mixtape</title>
  <meta name="description" content="A shareable virtual mixtape with a centered cassette and hidden video—audio only." />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Cassette Mixtape" />
  <meta property="og:description" content="A shareable virtual mixtape with a centered cassette and hidden video—audio only." />
  <meta property="og:image" content="https://images.unsplash.com/photo-1530977875151-aae9742d632a?q=80&w=1600&auto=format&fit=crop" />
  <meta name="twitter:card" content="summary_large_image" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --brand:#6c5ce7; --ink:#f2f5f7;
      --bg: radial-gradient(1200px 700px at 20% 10%, rgba(108,92,231,.25), transparent 60%),
            radial-gradient(800px 600px at 80% 20%, rgba(0,220,255,.20), transparent 60%),
            linear-gradient(180deg,#0b0b10 0%, #111217 60%, #0b0b10 100%);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:var(--ink);background:var(--bg);display:grid;place-items:center}

    .wrap{width:clamp(300px, 80vw, 860px); display:grid; gap:24px; justify-items:center; text-align:center;}

    .title{margin:0;font-size:clamp(28px,5vw,48px);line-height:1.05;font-weight:800}
    .byline{margin:4px 0 12px;color:#b9bec9}

    .stage{position:relative; display:grid; place-items:center; width:100%;}

    /* Cassette centered */
    .cassette{position:relative; width:min(84vmin, 720px); height:calc(min(84vmin, 720px)*0.58);
      border-radius:18px; background:linear-gradient(180deg,#20242b,#171a20);
      box-shadow:0 18px 60px rgba(0,0,0,.55), inset 0 0 0 2px rgba(255,255,255,.06);
      user-select:none; pointer-events:none; opacity:.96}
    .cassette::before,.cassette::after{content:"";position:absolute;left:0;right:0;height:22%;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02))}
    .cassette::before{top:0;border-radius:18px 18px 0 0}
    .cassette::after{bottom:0;border-radius:0 0 18px 18px}
    .label{position:absolute;inset:10% 8% auto 8%;height:32%;background:#f4f6ff;color:#222;border-radius:10px;box-shadow:inset 0 0 0 2px rgba(0,0,0,.06);display:flex;align-items:center;justify-content:center;font-weight:800;letter-spacing:.06em;text-transform:uppercase}
    .window{position:absolute;inset:auto 16% 24% 16%;height:30%;border-radius:10px;background:rgba(255,255,255,.06);box-shadow:inset 0 0 0 2px rgba(255,255,255,.08);display:flex;align-items:center;justify-content:space-between;padding:0 14%}
    .reel{position:relative; width:22%;aspect-ratio:1;border-radius:50%;background:radial-gradient(circle at 50% 50%, #e6e6e6 0 10%, #bbb 11% 32%, #222 33% 100%);
      box-shadow:inset 0 0 0 3px rgba(0,0,0,.35), 0 0 0 2px rgba(255,255,255,.05)}
    .reel::before,.reel::after{content:"";position:absolute;inset:50% auto auto 50%;translate:-50% -50%;background:#111;border-radius:50%}
    .reel::before{width:44%;height:44%;box-shadow:inset 0 0 0 2px rgba(255,255,255,.08)}
    .reel::after{width:8%;height:8%}
    .spokes{position:absolute;inset:0;display:grid;place-items:center}
    .spokes > i{position:absolute;width:10%;height:40%;background:#111;border-radius:4px}
    .spokes > i:nth-child(1){transform:rotate(0deg)}
    .spokes > i:nth-child(2){transform:rotate(60deg)}
    .spokes > i:nth-child(3){transform:rotate(120deg)}
    .spokes > i:nth-child(4){transform:rotate(180deg)}
    .spokes > i:nth-child(5){transform:rotate(240deg)}
    .spokes > i:nth-child(6){transform:rotate(300deg)}

    .spinning .reel.left{animation:spin 2.4s linear infinite}
    .spinning .reel.right{animation:spin-reverse 2.4s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes spin-reverse{to{transform:rotate(-360deg)}}

    .accent{position:absolute;right:14px;bottom:14px;padding:.35rem .6rem;border-radius:999px;background:var(--brand);color:#fff;font-size:.75rem;font-weight:700;letter-spacing:.04em}

    /* Controls */
    .controls{display:flex; gap:12px; align-items:center; justify-content:center}
    .btn{appearance:none;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);color:#fff;padding:12px 16px;border-radius:12px;cursor:pointer;font-weight:700}
    .btn:hover{background:rgba(255,255,255,.12)}
    .hint{color:#c8cfdb; font-size:14px}

    .links{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
    .pill{color:#eaf0ff;background:rgba(108,92,231,.18);border:1px solid rgba(108,92,231,.45);border-radius:999px;padding:8px 12px;text-decoration:none;font-size:14px}
    .pill:hover{background:rgba(108,92,231,.28)}

    /* Visually hide the player but keep it active for audio */
    #embedWrap{position:absolute; width:1px; height:1px; overflow:hidden; clip-path:inset(50%);}
  </style>
</head>
<body>
  <div class="wrap">
    <div>
      <h1 class="title" id="title">Cassette Mixtape</h1>
      <div class="byline" id="byline">by You</div>
    </div>

    <div class="stage">
      <!-- Hidden iframe holder (still required to play audio from YouTube/Spotify) -->
      <div id="embedWrap" aria-hidden="true">
        <iframe id="embed" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" allowfullscreen loading="lazy" title="Audio Player"></iframe>
      </div>

      <!-- Centered cassette graphic -->
      <div class="cassette" id="cassette">
        <div class="label" id="label">Side A — Mixtape</div>
        <div class="window">
          <div class="reel left"><div class="spokes"><i></i><i></i><i></i><i></i><i></i><i></i></div></div>
          <div class="reel right"><div class="spokes"><i></i><i></i><i></i><i></i><i></i><i></i></div></div>
        </div>
        <div class="accent">A60</div>
      </div>
    </div>

    <div class="controls">
      <button class="btn" id="playBtn">▶ Play</button>
      <button class="btn" id="pauseBtn" disabled>⏸ Pause</button>
    </div>
    <div class="hint">For reliable autoplay across devices, click Play once. After that, tracks advance automatically.</div>

    <div class="links" id="links"></div>
  </div>

  <script>
    // --------- PERSONALIZE ---------
    const CONFIG = {
      title: "Eren’s Cassette Mixtape",
      byline: "for you",
      message: "Click play once to let audio start; the reels spin while music plays.",
      credit: "curated by Eren",
      // Recommended: a YouTube PLAYLIST (auto-advances). Spotify playlist also works, but requires click and may limit previews.
      youtubeUrl: "https://www.youtube.com/playlist?list=PLMC9KNkIncKtPzgY-5rmhvj7fax8fdxoj",
      spotifyUrl: "https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M",
      providerUrl: "https://www.youtube.com/playlist?list=PLMC9KNkIncKtPzgY-5rmhvj7fax8fdxoj",
      links: [
        { label: "Open on YouTube", url: "https://www.youtube.com/playlist?list=PLMC9KNkIncKtPzgY-5rmhvj7fax8fdxoj" },
        { label: "Open on Spotify", url: "https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M" }
      ]
    };

    const $ = s => document.querySelector(s);
    function setText(sel,val){ const el=$(sel); if(el && val) el.textContent = val; }

    // Provider helpers
    function detectProvider(url){ if(!url) return null; const u=url.toLowerCase(); if(u.includes('youtube.')||u.includes('youtu.be')) return 'youtube'; if(u.includes('spotify.')) return 'spotify'; return null; }

    function ytEmbedFrom(url){ try{ const u=new URL(url); const list=u.searchParams.get('list'); if(list){ return `https://www.youtube-nocookie.com/embed/videoseries?list=${encodeURIComponent(list)}&modestbranding=1&rel=0&playsinline=1`; } let id=u.searchParams.get('v'); if(!id && u.hostname.includes('youtu.be')){ id=u.pathname.split('/').filter(Boolean)[0]; } if(id){ return `https://www.youtube-nocookie.com/embed/${encodeURIComponent(id)}?modestbranding=1&rel=0&playsinline=1`; } return url; }catch{ return url; } }

    function spotifyEmbedFrom(url){ try{ const u=new URL(url); const parts=u.pathname.split('/').filter(Boolean); const type=parts[0]; const id=parts[1]; if(type && id) return `https://open.spotify.com/embed/${encodeURIComponent(type)}/${encodeURIComponent(id)}`; return url; }catch{ return url; } }

    function embedSrcFrom(url){ const p=detectProvider(url); if(p==='youtube') return ytEmbedFrom(url); if(p==='spotify') return spotifyEmbedFrom(url); return ''; }

    // YouTube API — to control play/pause and get accurate state for spinning
    let ytApiLoaded=false, ytPlayer=null, provider=null;
    function loadYouTubeAPI(){ if(ytApiLoaded) return; ytApiLoaded=true; const s=document.createElement('script'); s.src='https://www.youtube.com/iframe_api'; document.head.appendChild(s); }
    window.onYouTubeIframeAPIReady = function(){ const iframe=$('#embed'); if(!iframe || !/youtube\./i.test(iframe.src)) return; ytPlayer = new YT.Player('embed', { events:{ onStateChange:(e)=>{
      // 1=PLAYING,2=PAUSED,0=ENDED,3=BUFFERING,5=CUE
      if(e.data===1) startSpin();
      if(e.data===2) stopSpin();
      if(e.data===0) { /* ended a track, playlist should auto-advance; keep spinning when next track starts */ }
    }}}); };

    function startSpin(){ $('#cassette').classList.add('spinning'); $('#playBtn').disabled=true; $('#pauseBtn').disabled=false; }
    function stopSpin(){ $('#cassette').classList.remove('spinning'); $('#playBtn').disabled=false; $('#pauseBtn').disabled=true; }

    function mountEmbed(url){
      provider = detectProvider(url);
      const base = embedSrcFrom(url);
      let src = base;
      if(provider==='youtube'){
        const hasQ = base.includes('?'); const origin = encodeURIComponent(location.origin);
        src = base + (hasQ?'&':'?') + `enablejsapi=1&origin=${origin}&autoplay=1`;
      } else if(provider==='spotify'){
        // Spotify ignores autoplay without a user gesture; we'll trigger play after click by focusing the iframe.
      }
      const iframe = $('#embed'); iframe.src = src; iframe.title = `${CONFIG.title || 'Mixtape'} — ${provider || 'player'}`;
    }

    async function handlePlay(){
      const chosen = CONFIG.providerUrl || CONFIG.youtubeUrl || CONFIG.spotifyUrl;
      if(!provider){
        // First click: mount and (for YT) load API
        mountEmbed(chosen);
        if(detectProvider(chosen)==='youtube') loadYouTubeAPI();
      }
      if(provider==='youtube'){ try{ ytPlayer && ytPlayer.playVideo && ytPlayer.playVideo(); }catch(e){} }
      if(provider==='spotify'){
        // Best effort: focus iframe to satisfy gesture requirement; user may need to click the play button inside Spotify the first time.
        $('#embed').focus();
      }
      startSpin();
    }

    function handlePause(){ if(provider==='youtube'){ try{ ytPlayer && ytPlayer.pauseVideo && ytPlayer.pauseVideo(); }catch(e){} } stopSpin(); }

    // Init UI
    (function init(){
      setText('#title', CONFIG.title); setText('#byline', CONFIG.byline); setText('#label', `Side A — ${CONFIG.title || 'Mixtape'}`);
      const linksBox = $('#links'); (CONFIG.links||[]).forEach(({label,url})=>{ const a=document.createElement('a'); a.className='pill'; a.href=url; a.target='_blank'; a.rel='noopener'; a.textContent=label; linksBox.appendChild(a); });
      $('#playBtn').addEventListener('click', handlePlay);
      $('#pauseBtn').addEventListener('click', handlePause);
      document.addEventListener('visibilitychange', ()=>{ if(document.hidden) stopSpin(); });
    })();
  </script>
</body>
</html>
